# パワーポンチ

こんにちは、プラットフォームエンジニアの中山です。

かつて出社が当たり前の時代、ホワイトボードを活用した活発な議論の風景をオフィスのあちこちで見ることができました。改めてホワイトボードを活用した議論を振り返ると …

- 自身の考えの整理
- 関係者の想像性の刺激
- 関係者の視点や疑問の引き出しに伴う問題の早期発見
- 関係者の認識あわせや理解度向上
- 関係者の論点へのフォーカス

など多くの観点で合理性があり、新しいアイデアや複雑なシステムを扱う際の強力な手段でした。

しかし、グローバル協業体制や働き方が多様化した状況下では、オフィスに集合することは少々ハードルが高くなりました。私たち LINE ヤフーもそのような状況にあり、加えて旧 LINE と旧ヤフーの組織文化の融合途上にあります。あらゆるギャップを軽減するためにも、以前のようにホワイトボードを活用した議論をしたいところですが、日常的にはオンラインコミュニケーションの質を高めてゆく必要があります。

そこで今回はホワイトボードを活用した議論の代替案として、ポンチ絵を多用したパワーポイントプレゼンテーション（パワーポンチと名付けてみました :-p）をご提案させていただきます。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-001.png' />

## ポンチ絵のメリット

第一に「作ることは考えることである」という言葉がありますが、伝え方に工夫をこらしつつポンチ絵を作る副作用として、自身の考えが整理されてゆくという効果があります。さらに、ポンチ絵は具体的な形として捉えやすいため、関係者が違和感や不明点を探しやすくなるとともに、視覚的な刺激が関係者の創造性を引き出し、新しいアイデアや解決策を生み出すきっかけにもなります。

総じて、ポンチ絵を多用したプレゼンテーションとそれに続く議論は、ホワイトボードを活用した議論に近しい効果を期待することができます。

蛇足ですが、目的に応じて

- パワーポイントの利用を禁止する
- 準備に時間をかけずありもののドキュメントを流用する

など採用することはあるものの、上で述べたメリットを最大化したいならば、ポンチ絵を多用したプレゼンテーション（とそれに続く議論）にコストをかけることはお勧めです。

## ポイント解説

それではスライド（元ファイルは <a href='https://github.com/nakayama-kazuki/2021/blob/master/pptx/power-punch.pptx'>こちら</a>）を用いてポンチ絵を多用したプレゼンテーションのポイントについて解説します。

まず、プレゼンテーション（とそれに続く議論）に有益である限り、躊躇せずにページ数を増やすことに慣れましょう。例えば、ある特定のスライドを参照するためにプレゼンテーション中にページを行ったり来たりするくらいならば、同じスライドを再掲しましょう（必要ならば何度でも）。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-002.png' />

再掲に伴う修正時の負担が懸念ならば「スライドマスター」から「レイアウトの挿入」で、繰り返し利用する情報をレイアウトとして一元管理し、再掲の都度「新しいスライド」から挿入することで対応できます。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-003.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-004.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-005.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-006.png' />

ページ数を増やすことに抵抗がなくなったところで <a href='https://techblog.yahoo.co.jp/entry/2023071830429434/'>CSP の記事</a> から引用したポンチ絵について、プレゼンテーションで説明する方法を考えてみましょう。例えば 5 つのステップに分けて説明したいとします。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-007.png' />

まずはポンチ絵を複製し、全体をグレーアウト表現 …

- 塗りつぶしを白に近い灰色
- 枠線を白に近い灰色
- テキストは白

のポンチ絵に変換してレイアウトに貼り付けます。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-008.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-009.png' />

そのレイアウトを使った新しいスライドに元のポンチ絵を貼り付け、そのスライドを 5 つのステップ分複製します。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-010.png' />

各ステップで説明したいところ以外を削除（結果として説明と関係のない部分がグレーアウト表現となる）して完成です。プレゼンテーションの際にスライドあたりにかける時間は 10 秒以内が目安です。こうすることで

- 全体のどこを説明しているのかが自明で参加者が誤解しにくい
- 短時間で見た目が変化するので参加者が退屈しない

といった効果を望めます。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-011.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-012.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-013.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-014.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-015.png' />

プレゼンテーション全体でも「いまこのへん」を示すことで

- 参加者が質問をするタイミングをつかめる
- 参加者に対して理解度確認などの投げかけができる

のような双方向性を促進しやすくなります。例えばこのスライドのように明度を反転させたスライドで章の狭間であることと、大雑把な進行状況を示します。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-016.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-017.png' />

次に注目を引き付ける手段を幾つかご紹介します。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-018.png' />

今回は <a href='https://github.com/nakayama-kazuki/202x/tree/main/data-gudeline'>データ活用の記事</a> から引用したポンチ絵を用い、ステップを分けてプライバシー保護の仕組を説明してみます。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-019.png' />

一つ目の方法は既にご紹介したグレーアウト表現を用いた方法です。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-020.png' />

クリーンルーム内へのデータ転送を説明し、

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-021.png' />

その後は個人データの取り出しができないことを説明します。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-022.png' />

クロス集計を行い、

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-023.png' />

その結果の統計値のみが取り出せることを説明します。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-024.png' />

グレーアウト表現を用いた方法が面倒ならば、もっと簡単な方法もあります。二つ目の方法は透明度が低い背景色の矩形を重ねる方法です。この例では透明度 10% の白を使っています。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-025.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-026.png' />

あとは一つ目の方法と同じです。色使いが少々ノイジーですが、こちらの方が手間はかかりません。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-027.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-028.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-029.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-030.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-031.png' />

三つ目は型抜きを使った方法です。スライドと同じサイズの矩形を使い、注目させたい部分を型抜きします。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-032.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-033.png' />

そして全体を適当な透明度と色に調整します。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-034.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-035.png' />

それを元画像に重ねることで、特定の対象に注目を引き付けることができます。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-036.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-037.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-038.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-039.png' />

四つ目は放射線や背景画像を用いる方法です。これらのパーツは再利用のためのテンプレートを用意しておくと便利です。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-040.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-041.png' />

次に変化の表現について考えてみます。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-042.png' />

これは実際にアカウント連携のトポトジーを議論しているときに用いたポンチ絵ですが、変化の Before と After のみを示した場合、関係者から良質な気付きのフィードバックを得ることはできません。これは Before と After に複数の変化が含まれ、思考が追いつかないためです。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-043.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-044.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-045.png' />

そこで検討の時系列に従って、まずは 2 つのエンティティーが統合されることを表現してみます。残像を使ったパラパラまんがで参加者のメンタルモデルに働きかけます。すると参加者は統合される両エンティティーの属性情報や、他のエンティティーとの関係性がどのように変化するのだろうか？という疑問に思い至り、同時に問題を解消するための創造性を発揮することができます。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-046.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-047.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-048.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-049.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-050.png' />

次にあるエンティティーのみ特別な扱いが必要になったことを表現します。しかし、この結果 UI でエンティティーの関係性を表現することが困難であることが参加者にもイメージしやすくなります。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-051.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-052.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-053.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-054.png' />

そこで全体のトポロジーに一貫性を持たせる案に至ったことを表現します。このように検討の経緯や中間段階における課題の表現を通じ、参加者から多くの視点を引き出し問題の早期発見につなげることができました。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-055.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-056.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-057.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-058.png' />

参加者には予断や誤解をあたえることなく、フラットにプレゼンテーションを聞いてもらいましょう。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-059.png' />

同じアルファベットのコンポーネントを連結したいとして、

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-060.png' />

これを使う人はいませんよね。予断どころか誤解を招いてしまいます。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-061.png' />

ではこれならどうでしょうか？

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-062.png' />

最初よりはマシですが、まだ誤解の余地があるので、

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-063.png' />

線に背景色の矩形を重ね、上を通る線を「最前面へ移動」することで誤解の余地を軽減できます。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-064.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-065.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-066.png' />

面倒でなければ交点をずらすことでさらに改善できます。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-067.png' />

次に正三角形をパワーポイントのガイドにあわせて中央に配置します。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-068.png' />

しかし、このガイドの中央と正三角形の重心にはズレがあります。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-069.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-070.png' />

なのでガイドの中央から各頂点を連結したポンチ絵の場合、頂点Ａが特別な存在であるように予断を与えてしまう懸念があります。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-071.png' />

正三角形の重心の位置は、

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-072.png' />

垂線の交点となります。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-073.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-074.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-075.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-076.png' />

これならば頂点Ａと頂点Ｂと頂点Ｃは対等です。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-077.png' />

おまけで正五角形の重心を考えてみましょう。正五角形をパワーポイントのガイドにあわせて中央に配置した場合

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-078.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-079.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-080.png' />

若干アンバランスな印象を抱かせるポンチ絵になりました。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-081.png' />

回転させてみると

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-082.png' />

アンバランス感も目立ちます。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-083.png' />

そこで、こんな感じで頂点と辺、および頂点同士を結び、

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-084.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-085.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-086.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-087.png' />

最後は目測で交点にあわせて、

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-088.png' />

ここが正五角形の重心です。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-089.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-090.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-091.png' />

回転させてみても

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-092.png' />

正五角形です。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-093.png' />

さらに回転させてみても

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-094.png' />

やはり正五角形です。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-095.png' />

ストレージはポンチ絵に頻出しますが、図形には円柱が二種類存在します。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-096.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-097.png' />

Ａの円柱は縦長にすると不細工ですね ^^;

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-098.png' />

ちなみに矩形と楕円形の組み合わせでも円柱を表現できます。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-099.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-100.png' />

ここでグラデーション塗りつぶしを使い、ストレージへのデータ蓄積を表現してみます。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-101.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-102.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-103.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-104.png' />

Ｂの円柱の場合はグラデーション塗りつぶしではなく、重ね合わせで蓄積や割合を表現することができます。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-105.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-106.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-107.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-108.png' />

結論としてＡの円柱よりはＢの円柱を使った方が良さそうですね。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-109.png' />

次は <a href='https://blog.techscore.com/entry/2023/10/06/110100'>SameSite の記事</a> から引用したポンチ絵を用いた表について考えてみます。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-110.png' />

ポンチ絵と表を分離することで、見やすくまとまります。しかし、どのような場合に Cookie が送信されるのかを理解するためには、両方のページを行ったり来たりする必要があり、それは参加者の理解の妨げにもなります。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-111.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-112.png' />

ならばポンチ絵ごと表にしてしまうのもひとつの案です。ぱっとみた印象ではごちゃごちゃしていますが、どのような場合に Cookie が送信されるのかを端的に表現することができました。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-113.png' />

最後に、おもったよりも簡単に何でも描けるということをお伝えします。ポンチ絵を駆使して参加者の想像性をおおいに刺激してください。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-114.png' />

まずは三角形を組み合わせたダイヤモンドです。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-115.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-116.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-117.png' />

着色は適当に（本当に適当）グラデーションを付けます。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-118.png' />

グループ化して拡大縮小、回転すればダイヤモンドがざくざくです。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-119.png' />

バッグや財布なども簡単に作れます。お買い物や広告のユースケースなどで使いまわせます。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-120.png' />

矩形の周囲を曲線で囲み

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-121.png' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-122.pn0g' />
<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-123.png' />

丸みを帯びた矩形を作れます。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-124.png' />

他の多角形でも同様です。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-125.png' />

例えば、これらをつなげて接合すれば棒人間の一丁あがり、です。

<img src='https://raw.githubusercontent.com/nakayama-kazuki/202x/main/power-punch/img/page-126.png' />

以上になりますが、ポンチ絵を多用したパワーポイントプレゼンテーションがみなさまのオンラインコミュニケーションの改善のヒントになれば幸いです。

p.s.

蛇足ですが、今回の記事には 100 枚以上の画像を張り付けていますが、パワーポイントで以下のマクロを実行すると全てのスライドを PNG 画像として保存することができます。

```
Sub SaveSlidesAsPNG8()
    Dim pptSlide As Slide
    Dim outputPath As String
    Dim slideIndex As Integer
    outputPath = "YOUR OUTPUT PATH"
    For Each pptSlide In ActivePresentation.Slides
        slideIndex = pptSlide.slideIndex
        pptSlide.Export outputPath & "page-" & Format(slideIndex, "000") & ".png", "PNG", 1600
    Next pptSlide
End Sub
```

加えて、マクロで生成した画像は PNG24（が 100 枚以上）なので、通信制限を気にする人のために減色～サイズ削減（およそ 6.8 MB のファイルが 3.0 MB）しました。

```
define('MAX_BIT', 7);
define('MINIMUM', 0);

function detect_palette2($in_im, $in_w, $in_h)
{
    $palette = array();
    for ($y = 0; $y < $in_h; $y++) {
        for ($x = 0; $x < $in_w; $x++) {
            $color = imagecolorat($in_im, $x, $y);
            if (array_key_exists($color, $palette)) {
                $palette[$color]++;
            } else {
                $palette[$color] = 1;
            }
        }
    }
    $colors = 1;
    for ($i = 1; $i <= MAX_BIT; $i++) {
        $colors *= 2;
        if ($colors >= count($palette)) {
            break;
        }
    }
    return $colors;
}

define('INPUT_DIR', 'YOUR INPUT PATH');
define('OUTPUT_DIR', 'YOUR OUTPUT PATH');

if (!is_dir(INPUT_DIR)) {
    exit;
}

$dh = opendir(INPUT_DIR);
while (($file = readdir($dh)) !== FALSE) {
    $path = INPUT_DIR . "/{$file}";
    if (!is_file($path)) {
        continue;
    }
    $im = @imagecreatefrompng($path);
    imagepalettetotruecolor($im);
    $w = imagesx($im);
    $h = imagesy($im);
    $im_original_color = imagecreatetruecolor($w, $h);
    imagecopy($im_original_color, $im, 0, 0, 0, 0, $w, $h);
    $colors = detect_palette2($im, $w, $h);
    imagetruecolortopalette($im, FALSE, $colors);
    imagecolormatch($im_original_color, $im);
    imagedestroy($im_original_color);
    echo "filename : {$file}, colors : {$colors}\n";
    imagepng($im, OUTPUT_DIR . "/{$file}");
    imagedestroy($im);
}
closedir($dh);
```
