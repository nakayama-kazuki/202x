<html>
<body>
<form id='test-form'>
<label>
sample input : <input type='text' id='input-text' value='test input' />
</label>
<button type='submit'>send</button>
</form>
<script>

const APIDOMAIN = 'api.pj-corridor.net';


const img = document.createElement('img');
img.src = 'https://' + APIDOMAIN + '/personalitytest/lambda/challenge';
img.style.width = '1px';
img.style.height = '1px';
img.style.visibility = 'hidden';

const form = document.getElementById('test-form');
form.addEventListener('submit', async (in_ev) => {
	in_ev.preventDefault();
	const payload = {text : document.getElementById('input-text').value};
	try {
		const response = await fetch('https://' + APIDOMAIN + '/personalitytest/lambda/generate', {
			method : 'POST',
			headers : {
			  'Content-Type' : 'application/json'
			},
			// required to send challenge cookie
			credentials : 'include',
			body : JSON.stringify(payload)
		});
		console.log('response : ', await response.text());
	} catch (err) {
		console.error(err);
	}
});

</script>
</body>
</html>
